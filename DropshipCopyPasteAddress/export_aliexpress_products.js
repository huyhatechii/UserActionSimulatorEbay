




function function_name() {
	getStorageLocalSet('aliexpressSeedProductSet', function(aliexpressSeedProductSet) {
		loadDoc('https://docs.google.com/spreadsheets/d/e/2PACX-1vS3aA-m8cajpff0roLWci2xd4z0xlsnKrMN806Lpe2qcFdkX4lT-2BVmURgABGblyzlNef-0YierqyH/pubhtml', function(xhttp) {
		var d = document.createElement('div')
        d.innerHTML = xhttp.responseText
        var softmerge = d.getElementsByClassName('waffle')[0].getElementsByClassName('softmerge-inner')
        for (i = 0; i < softmerge.length; i++) {
        	var link = softmerge[i].textContent
        	var id = link.split('/')[5].split('.html')[0]
        	//if ()
        	console.log(id);
        }
		})
	})
	
}

function exportAliexpressProducts() {
	var key = 'listedItemIdSet' + document.getElementsByName('ebayAccountId')[0].value
    console.log('Key = ' + key)
    var arr = ["32946678552","32957840927","32964162239","32928368651","32927037791","32924601278","32954657798","32958303073","32927899289","32927305290","32955332011","32958310408","32945570876","32960651948","32960703793","32822405928","32398387327","32943465071","32955248737","1000007059369","32924589633","32955352725","32958231747","32932851026","1771584241","32821192284","32958311016","32956898801","32958199986","32740038815","32955308605","32954773148","32955456435","32958299102","32925799741","32957361603","32957349658","32925819006","32925791920","32929459303","32955416621","32950152822","32815468429","32944252048","32828071025","32929317376","32879950228","32911233028","32942037499","32911938736","32900577183","32956958700","32905842130","32914513691","32913196199","32927654211","32909660636","32810419083","32901065019","32870519727","32917841095","32848825688","32796140404","32834910895","32909469500","32918260438","32907003527","32948435483","32917754710","32904090043","32845197245","32706232871","32931666148","32958271899","32914129111","32916840085","32924367352","32923742379","32820919157","32922609503","32914162324","32788672862","32903727826","32868854449","32910542646","32914405311","32927518222","32916216346","32873319903","32925906488","32921149094","32952550649","32949808714","32946534987","32480937949","32912459516","32922717267","32912620168","32917735098","32915597125","32909170507","32951442630","32915365604","32821448876","32805602131","32924184856","32911791297","32952140180","32534398062","32949738997","32906311468","32930492682","32918410493","32951734868","32946744440","32867936790","32923999959","32919891079","32913276024","32927289464","32921900451","32845062417","32956794411","32903650505","32908323731","32931354152","32909100282","32924118458","32919576042","32914545038","32921804490","32904222025","32917128581","32535928862","32534141993","32911824672","32955667327","32923412408","32925247407","32799172026","32736091337","32824451778","32919519702","32928303640","32931494879","32749824112","32536036311","32920500144","32909377691","32921317151","32534398491","32919485771","32917515988","32807761917","32943478010","32921017601","32489754139","32947365475","32910895044","32916334631","32801285201","32922178342","32919451208","32908064871","32917580876","32947655159","32797157028","32919519681","32878808545","32921781480","32824191012","32877539395","32430168854","32949116553","32952609669","1000007016043","32955183533","32449200431","32835179076","32907598658","32925703118","32922553694","32942081216","32955480137","32957636905","32952847844","32943837340","32958239732","32833730312","32931426048","32622365978","32944700688","32947051757","32833068214","32947139139","32956806570","32833678315","32839673321","32946190263","32946522983","32919622765","32877487805","32910546626","32955280477","32843159468","32825557415","32950213278","32956926416","32823560448","32798773572","32955420724","32954589286","32952919219","32903381236","32740559447","32828328146","32836879191","32849228444","32875850317","32904753518","32923149591","32914453397","32881352413","32917046148","32915565263","32953602542","32856584943","32903774054","32902475039","32868878068","32924066895","32840771270","32889098848","32957117119","32816032119","32879080146","32913037584","32889585407","32850366092","32911838730","32923396556","32952899579","32949513968","32958291739","32823715981","32941944230","32953251567","32821005209","32955336985","32674518516","32912013216","32841144276","32874098600","32923708555","32789116587","32922804624","32905258849","32908845820","32751259480","32947592906","32815314421","32891631162","32720950070","32924291887","32959422938","32956798879","32946689069","32955504145","32825159039","32952491002","32907552183","32907816044","32918422140","32918552075","32756946467","32941973511","32901013961","32907007774","32945279240","32878633633","32949269457","1000007111027","32925647684","32951474083","32960935557","32958415051","32823588274","32923532917","32923070990","32925647764","32953915867","32954343229","32955412371","32945227734","32949052811","32958303063","32772400442","32912155244","32955191279","32904304472","32909309108","32921234361","32947445990","32813787827","32792949336","32916725504","32902041721","32909688164","32933374946","32801012336","32948332005","32656503487","32948300352","32547776056","32825145794","32919431851","32925759973","32816501245","32951313306","32900840053","32939105582","32906999294","32910455671","32871810522","32922993514","32949149652","32913035533","32915102296","32956830268","32930267758","32949110443","32956930420","32953484037","32943237549","32927663939","32925926817","32925524998","32925954340","32958291017","32911757032","32922350803","32915930384","32911144287","32918587683","32916974082","32913093340","32736913675","32904215683","32946713820","32944279095","32938571504","32949542420","32661459929","32929413507","32958031465","32930283632","32911722762","32925516956","32915846696","32908201472","32907662056","32906027905","32821378491","32922244149","32902337855","32953461916","32913266371","32747617614","32786938627","32537650904","32536063587","32889765988","32962799535","32919973869","32958447146","32919813261","32932512355","32914078526","32930965156","32801917076","32912445295","32905796473","32881339487","32949404907","32920975310","32722225685","32890411502","32903420819","32949588708","32912463370","32924086040","32907280559","32911025484","32918286956","32952128308","32924131498","32791664654","32921976983","32905309444","32793507696","32913048668","32760867181","32796395838","32949137554","32928291345","1000006619906","32952115354","32905002328","32931181323","32922039033","32811738816","32915114661","32905374361","32912465349","32919870279","32921443481","32910457854","32951734225","32948923423","32947982231","32951231049","32909491036","32948150289","32957674797","32659757896","32956766843","32931322871","32952769583","32955432199","32917588722","32754901655","32903872049","32918711920","32906900842","32914070204","32737600730","32915607613","32948478759","32923618942","32617224643","32952055682","32907938068","32961183986","32941997943","32914417141","32882805085","1000006893987","32923991135","12345","32915651697","32946066811","32874453040","32922013116","32948031301","32802929555","32910266310","32957109896","32805584242","32910518897","32904284683","32949429291","32721229743","32904380730","32941250631","32949401166","32952891612","32803029921","32906928958","32876573284","1000006663854","1000006683722","32670643504","32949406588","32919487267","32912373563","1000006914422","32957916360","32907594835","32946926331","32960657127","32793756710","32907846438","1000003892014","32923218731","32928092126","32921929344","32944701075","32930492041","32946922786","32944641183","32906549072","32909452966","32946412062","32908609116","32909044525","32738181314","32906493625","32811530401","32927779118","32907918262","32953243539","32953682701","32910412458","32925023946","32789664118","32908297489","32916698823","32804661369","32764353109","32892466297","32836847861","32921208618","32911714883","1000006639031","32828787895","32952987304","32822341950","32823033550","32946309364","32949931168","32949911427","32955536660","32818313680","32907658395","32916716491","32703582993","32922589041","32792987423","32799864848","32878537617","32826010223","32958287184","32789816367","32922208871","32831319909","32920429137","32947767630","32931570517","32945670371","32954749423","32958263470","32513644484","32951080877","32960641202","32943418158","32916760696","32881499264","32818365386","32829124394","32951223897","32948300556","32918726058","32908285973","32534189865","32783199530","32848501615","32957153226","32920009292","32903817994","32912991875","32324721988","32949354282","32947041152","32923486300","32821488826","32751979953","32804767213","32824413568","32910585191","32917911793","32662508029","32917790378","32920084445","32827027321","32930708754","32921543840","32915826948","32920311454","32908313788","32801331143","32916735196","32956257067","32915607631","1000007189785","32952483812","32915827354","1000006610791","32911414704","32822516833","32907276455","32921269554","32958431129","32958164371","32959442749","32788034364","32919129217","1000007123020","32930484239","32821116697","32946683003","32784999171","32813649627","32958411241","32842092345","32921938351","32767108825","32908572780","32954545949","32951931138","32948924676","32958243710","32951895667","32930363243","32945204585","32954721015","32958267233","32958231645","32956622367","32948603069","32945145010","32948551665","32809319212","1000006700902","32947721775","32859237827","32885039464","32907634243","32485948705","32664726142","32817605403","32934567482","32909465687","32804948441","32958367781","32919641026","32448182032","32913858498","32760481366","32961661210","32947995896","32909267732","32821939866","32950814635","32950814669","32946673285","32950243952","32950303250","32813900195","32906762783","32907862706","32922329903","32922108131","32909347264","32925171870","32951743537","32906875227","32910354822","32749342660","32921097235","32853102320","32922064511","32823228912","32823240358","32907726356","32704268879","32908608401","32923376953","32924355029","32953516996","32888292164","32912477146","32728880913","32924062594","32922225975","32880342119","32876375744","32879798863","32954569714","32826076746","32927650812","32829376238","32772446360","32928766626","32958423303","32954617075","32927678136","32922025765","32926121377","32745498087","32924899967","32812028892","32959602704","32803093472","32870252541","32947422652","32953416682","32956794292","32953139687","32958203869","32954393920","32948051525","32958990778","32953068263","32915048103","32948537670","32799376767","32949160431","32874241465","32954434562","32923608219","32863867115","32819985131","32953008765","32757393635","1000007016023","32931346427","32949167382","32922572903","32870189579","32926386679","32536055510","1000007032837","32870209278","32429434035","32948886952","32947363829","32823588287","32920844653","32922053187","32797776022","32799427767","32923676651","32913687942","32954047039","32439668443","32879930656","32928255439","32930712657","32929625689","32910185571","32958779493","32910181648","32536171065","32916604303","32957854647","32947180251","32762856931","32922949034","32905440714","32810158824","32956890739","32937467113","32925862579","32906421172","32925415909","32927245668","32910674805","32914572736","32925475387","32922020358","32917048872","32922781205","32921936643","32922510807","32948732456","32781395973","32918422124","32923334964","32943257784","32948860673","32902357805","32926127119","32916894754","32920809023","32960755272","32951426907","32950157975","32911894801","32811621215","32922342944","1000006992828","32907895531","32749056909","32912605967","32919777943","32922113010","32912419807","32922652090","32906533906","32920540983","32950446446","32920611890","32915831865","32796378039","32749816193","32880234707","32906621216","32924066139","32751343090","32953714516","32878637529","32813460287","32875434456","32921077330","32915436898","32878844151","32791414530","32825623612","32905421155","32901978959","32779412400","32950699214","32958279267","32909424188","32909998843","32899829264","32875854269","32881463764","32947613206","32804790457","32914588013","32919646161","32946374452","32923266645","32919274993","32929263463","32922681725","1000006590023","32924482030","32879695882","32957290443","32905880392","32899805795","32911479891","32959490325","32917719360","1000006897996","32930560110","32836211588","32641632554","32958783335","32942884265","1000007004615","32959779026","32923168910","32895417501","32828907674","32913015998","32726189173","32955312068","32951078562","32532679432","32922673364","32956244019","32909320520","32919741127","32742903034","32922605407","32922634591","32909562603","32924295324","32913364114","32948126561","32953228368","32922996812","32960367032","32924184759","32932656977","32952071087"]
	var listedItemIdSet = new Set(arr)
	console.log(listedItemIdSet);
	setStorageLocalSet(key, listedItemIdSet)
}
function downloadFile() {
	var csvContent = 'ItemId;Aliexpress Link\n';
	getStorageLocalSet('aliexpressSeedProductSet', function(aliexpressSeedProductSet) {
		var aliexpressSeedProductArr = Array.from(aliexpressSeedProductSet)
		console.log(aliexpressSeedProductArr.length);
		for (i = 0; i < aliexpressSeedProductArr.length; i++) {
		   var dataString = aliexpressSeedProductArr[i] + ';' + 'https://www.aliexpress.com/item//' + aliexpressSeedProductArr[i] + '.html';
           csvContent += i < aliexpressSeedProductArr.length ? dataString + '\n' : dataString;
		}
        download(csvContent, 'aliexpress-seed-products.csv', 'text/csv;encoding:utf-8');
	})
}
// YHNOO - Mesprout - AISESI - YOUPANGPANG - Skunhe - MEINVPENG - zlking - kacasesi 
function loadNextPage(pageIndex) {
    loadDoc('https://www.aliexpress.com/af/cactus-plants.html?SearchText=cactus+plants&d=y&initiative_id=SB_20190303110804&origin=n&catId=0&isViewCP=y&jump=afs&page=' + pageIndex, function(xhttp) {
        var d = document.createElement('div')
        d.innerHTML = xhttp.responseText
        var itemInfArr = d.getElementsByClassName('info')
        //console.log(itemInfArr);
        getStorageLocalSet('aliexpressSeedProductSet', function(aliexpressSeedProductSet) {
            console.log(aliexpressSeedProductSet);
            for (var i = 0; i < itemInfArr.length; i++) {
                var info = itemInfArr[i]
                //console.log(info);
                var id = info.children[0].children[0].href.split('.html?')[0].split('/')[5]
                var link = 'https://www.aliexpress.com/item//' + id + '.html'
                //console.log(link);
                var price = parseFloat(info.getElementsByClassName('price price-m')[0].children[0].textContent.trim().split('$')[1].split('-')[0])
                var order = 0
                if (info.getElementsByClassName('rate-history')[0].textContent.trim().split('Orders').length > 1) {
                	order = parseInt(info.getElementsByClassName('rate-history')[0].textContent.trim().split('Orders')[1].split('(').join('').split(')').join('').trim())
                }
                //console.log(price);
                //console.log(order);
                if (price < 1) {
                    aliexpressSeedProductSet.add(id)
                }
            }
            setStorageLocalSet('aliexpressSeedProductSet', aliexpressSeedProductSet)
            console.log(aliexpressSeedProductSet.size);
          
            loadNextPage(++pageIndex)
            
        })
    })
}
